<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WeatherMap</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>


  <style>
    #map {
      margin: 0 auto;
      height: 400px;
      width: 80%
    }
  </style>
</head>
<body>

<div id="weather-info"></div>

<div id='map'></div>
<script src ="js/keys.js"></script>
<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>

<script>
  let latLong = [29.7604, -95.3698];
  $.get(`https://api.openweathermap.org/data/2.5/forecast?lat=${latLong[0]}&lon=${latLong[1]}&units=imperial&appid=${openWeather}`).done(function(data) {
    console.log(data);
    let todayDate = new Date(data.list[0].dt * 1000);
    let month;
    let day;

    switch (todayDate.getMonth()) {
      case 0:
        month = 'January';
        break;
      case 1:
        month = 'February';
        break;
      case 2:
        month = 'March';
        break;
      case 3:
        month = 'April';
        break;
      case 4:
        month = 'May';
        break;
      case 5:
        month = 'June';
        break;
      case 6:
        month = 'July';
        break;
      case 7:
        month = 'August';
        break;
      case 8:
        month = 'September';
        break;
      case 9:
        month = 'October';
        break;
      case 10:
        month = 'November';
        break;
      case 11:
        month = 'December';
        break;
      default:
        month = 'Smarch';
        break;
    }

    switch (todayDate.getDay()) {
      case 0:
        day = 'Sunday';
        break;
      case 1:
        day = 'Monday';
        break;
      case 2:
        day = 'Tuesday';
        break;
      case 3:
        day = 'Wednesday';
        break;
      case 4:
        day = 'Thursday';
        break;
      case 5:
        day = 'Friday';
        break;
      case 6:
        day = 'Saturday';
        break;
      default:
        day = 'Stan\'s Day';
        break;
    }

    let weatherHTML = `<section><h1>${day}, ${month} ${todayDate.getDate()}</h1><p>${data.list[0].main.temp_max} / ${data.list[0].main.temp_min}</p></section>`;

    $("#weather-info").html(weatherHTML);
  });
</script>

<pre id="coordinates" class="coordinates"></pre>

<script>

  $(function(){
    mapboxgl.accessToken = myMapBox;
  const coordinates = document.getElementById('coordinates');
  const map = new mapboxgl.Map({
    container: 'map',
// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
    style: 'mapbox://styles/mapbox/streets-v12',
    center: [-97.8561, 27.5159],
    zoom: 2
  });

  const marker = new mapboxgl.Marker({
    draggable: true
  })
          .setLngLat([-97.8561, 27.5159])
          .addTo(map);

  function onDragEnd() {
    const lngLat = marker.getLngLat();
    coordinates.style.display = 'block';
    let newCoordinates = (lngLat.lat, lngLat.lng)
    coordinates.innerHTML = `Longitude: ${lngLat.lng}<br />Latitude: ${lngLat.lat}`;
  }

  marker.on('dragend', onDragEnd);

  });

</script>

</body>
</html>